## 系统建模(内置核心模块设计部分)报告

根据需求分析报告，进行系统建模

### 一、系统架构

初步设计整个系统的架构如下：<br>
<img src="https://gitee.com/e-year/images/raw/master/img/202406170031206.jpg">

整个系统被分为数据库、后端、前端三个子系统<br>
数据库用于保存系统所需的数据，包括商品信息、库存信息、销售信息等<br>
后端用于与数据库进行交互，进行数据的维护操作<br>
前端用于与用户的交互，用户对前端的操作会生成相应的指令发送给后端，从而完成对数据库的更新<br>

### 二、用例建模

<img src="https://gitee.com/e-year/images/raw/master/img/202406170031124.jpg">

用例描述：

| 用例名：注册 |                                                              |
| :----------: | :----------------------------------------------------------- |
|    参与者    | 管理员                                                       |
|   前置条件   | 管理员访问系统网站并点击注册按钮                             |
|  基本事件流  | 1、管理员输入账号密码，并重复密码，<br>2、点击注册按钮       |
|  扩展事件流  | 1a、账号密码出现非法字符，注册失败<br>1b、两次密码不相同，注册失败<br>1c、账号名已存在，注册失败 |
|   后置条件   | 系统录入注册信息                                             |

| 用例名：登录 |                                          |
| :----------: | :--------------------------------------- |
|    参与者    | 管理员                                   |
|   前置条件   | 管理员访问系统网站                       |
|  基本事件流  | 1、管理员输入账号密码<br>2、点击登录按钮 |
|  扩展事件流  | 1a、账号密码错误，登录失败               |
|   后置条件   | 跳转管理系统主页面                       |

| 用例名：商品信息管理 |                                                              |
| :------------------: | :----------------------------------------------------------- |
|        参与者        | 管理员                                                       |
|       前置条件       | 管理员登录并进入商品信息管理页面                             |
|      基本事件流      | 管理员选择以下四种操作之一<br>1、管理员点击添加按钮<br>&emsp;&emsp;1.1、管理员依次输入商品id、名称、单价、描述、规格、分类信息<br>&emsp;&emsp;1.2、管理员点击提交按钮<br>&emsp;&emsp;1.3、系统在商品信息表中添加条目，完成添加操作<br>2、管理员点击想要删除条目后的删除按钮<br>&emsp;&emsp;2.1、系统在数据库中删除条目<br>&emsp;&emsp;2.2、库存中删除该商品的库存信息，完成删除操作<br>3、管理员点击想要修改条目后的修改按钮<br>&emsp;&emsp;3.1、管理员修改对应的信息字段<br>&emsp;&emsp;3.2、管理员点击提交按钮<br>&emsp;&emsp;3.3、系统在数据库中修改条目，完成修改操作<br>4、搜索商品条目<br>&emsp;&emsp;4.1、管理员选择搜索的字段，包括商品编号、名称、规格、价格、分类、描述<br>&emsp;&emsp;4.2、管理员输入搜索文本<br>&emsp;&emsp;4.3、管理员点击搜索按钮<br>&emsp;&emsp;4.4、系统在数据库的对应字段中搜索条目，并返回给页面，完成搜索操作 |
|      扩展事件流      | 1.2a、输入信息不完整，则提交失败<br>3.2a、输入信息不完整，则提交失败<br>4.3a、搜索文本为空，搜索失败 |
|       后置条件       | 刷新页面信息                                                 |


| 用例名：采购信息管理 |                                                              |
| :------------------: | :----------------------------------------------------------- |
|        参与者        | 管理员                                                       |
|       前置条件       | 管理员登录并进入采购信息管理页面                             |
|      基本事件流      | 管理员选择以下四种操作之一<br>1、管理员点击添加按钮<br>&emsp;&emsp;1.1、管理员依次输入采购订单编号、采购商品编号、日期、数量、单价、供货商信息<br>&emsp;&emsp;1.2、管理员点击提交按钮<br>&emsp;&emsp;1.3、系统在采购信息表中添加条目<br>&emsp;&emsp;1.4、系统自动增加商品对应的库存量，完成添加操作<br>2、管理员点击想要删除条目后的删除按钮<br>&emsp;&emsp;2.1、系统检查删除该订单后是否会导致库存为负，并修改相应库存信息<br>&emsp;&emsp;2.2、系统在数据库中删除该条目<br>&emsp;&emsp;2.3、系统减去商品对应的库存量，完成删除操作<br>3、管理员点击想要修改条目后的修改按钮<br>&emsp;&emsp;3.1、管理员修改对应的信息字段<br>&emsp;&emsp;3.2、管理员点击提交按钮<br>&emsp;&emsp;3.3、系统在数据库中修改该条目<br>&emsp;&emsp;3.4、系统修改对应的库存量，完成修改操作<br>4、搜索商品条目<br>&emsp;&emsp;4.1、管理员选择搜索的字段，包括订单id、商品id、供货商、购买日期、单价、数量<br>&emsp;&emsp;4.2、管理员输入搜索文本<br>&emsp;&emsp;4.3、管理员点击搜索按钮<br>&emsp;&emsp;4.4、系统在数据库的对应字段中搜索条目，并返回给页面，完成搜索操作 |
|      扩展事件流      | 1.2a、输入信息不完整，则提交失败<br>1.3a、如果商品编号不存在或订单编号已经存在，则添加失败<br>2.1a、如果删除该进货订单导致库存量为负数，则删除失败<br>3.2a、输入信息不完整，则提交失败<br>3.3a、如果商品编号不存在或订单编号已经存在，则修改失败<br>4.3a、搜索文本为空，搜索失败 |
|       后置条件       | 刷新页面信息                                                 |


| 用例名：销售信息管理 |                                                              |
| :------------------: | :----------------------------------------------------------- |
|        参与者        | 管理员                                                       |
|       前置条件       | 管理员登录并进入销售信息管理页面                             |
|      基本事件流      | 管理员选择以下四种操作之一<br>1、管理员点击添加按钮<br>&emsp;&emsp;1.1、管理员依次输入销售订单编号、销售商品编号、日期、数量、单价信息<br>&emsp;&emsp;1.2、管理员点击提交按钮<br>&emsp;&emsp;1.3、系统在销售信息表中添加条目<br>&emsp;&emsp;1.4、系统减去商品对应的库存量<br>2、管理员点击想要删除条目后的删除按钮<br>&emsp;&emsp;2.1、系统修改相应库存信息<br>&emsp;&emsp;2.2、系统在数据库中删除条目，完成删除操作<br>3、管理员点击想要修改条目后的修改按钮<br>&emsp;&emsp;3.1、管理员修改对应的信息字段<br>&emsp;&emsp;3.2、管理员点击提交按钮<br>&emsp;&emsp;3.3、系统在数据库中修改条目<br>&emsp;&emsp;3.4、系统修改商品对应的库存量，完成修改操作<br>4、搜索商品条目<br>&emsp;&emsp;4.1、管理员选择搜索的字段，包括订单id、商品id、销售日期、单价、数量<br>&emsp;&emsp;4.2、管理员输入搜索文本<br>&emsp;&emsp;4.3、管理员点击搜索按钮<br>&emsp;&emsp;4.4、系统在数据库的对应字段中搜索条目，并返回给页面，完成搜索操作 |
|      扩展事件流      | 1.2a、输入信息不完整，则提交失败<br>1.3a、如果商品编号不存在或订单编号已经存在，则添加失败<br>1.4a、如果购买数量大于对应商品的库存量，则添加失败<br>3.2a、输入信息不完整，则提交失败<br>3.3a、如果商品编号不存在或订单编号已经存在，则修改失败<br>4.3a、搜索文本为空，搜索失败 |
|       后置条件       | 刷新页面信息                                                 |


| 用例名：库存管理 |                                                              |
| :--------------: | :----------------------------------------------------------- |
|      参与者      | 管理员                                                       |
|     前置条件     | 管理员登录并进入库存管理页面                                 |
|    基本事件流    | 1、管理员点击修改按钮<br>2、管理员修改商品编号或者库存数量<br>3、管理员点击提交按钮<br>4、系统修改数据库中相应数据，完成修改操作 |
|    扩展事件流    | 3a、如果输入有空值，提交失败<br>4a、如果库存量为负数，则修改失败<br>4b、如果商品编号不存在，则修改失败 |
|     后置条件     | 刷新页面信息                                                 |

### 三、活动图建模

系统活动图如下：
<img src="https://gitee.com/e-year/images/raw/master/img/202406170031314.jpg">

以商品信息管理为例，具体活动图如下,进货订单管理、销售订单管理、库存管理的活动图类似
<img src="https://gitee.com/e-year/images/raw/master/img/202406170031195.jpg">
约束指的是数据库的约束，包括外码约束、库存不能为负的约束，在下面的数据库设计中会描述

### 四、状态图建模

系统状态图如下：
<img src="https://gitee.com/e-year/images/raw/master/img/202406170031805.jpg">

### 五、数据库ER图建模

数据库设计如下：
<img src="https://gitee.com/e-year/images/raw/master/img/202406170031375.jpg">

转换为至少满足3NF的关系模式：
<img src="https://gitee.com/e-year/images/raw/master/img/202406170031774.jpg">

除了ER图中描述的外码约束外，还需添加库存不小于0的约束，任何违反该约束的操作都不应被执行

### 六、类图建模

后端的类图如下：

<img src="https://gitee.com/e-year/images/raw/master/img/202406170031514.jpg">

其中，model类执行与数据库交互的操作，model定义的字段与数据库对应表的字段相同，通过model可以对数据库中的数据进行增删查改等操作

ModelSerializer执行序列化与反序列化的操作，通过ModelSerializer可以执行数据类型转换操作，为前后端提供通信的条件

ModelViewSet执行与前端交互的操作，通过使用router注册viewset，可以让前端通过url执行后端的相应函数并接收返回数据，渲染前端界面

